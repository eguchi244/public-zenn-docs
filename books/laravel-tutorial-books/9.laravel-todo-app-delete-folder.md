---
title: "入門09 - [ToDoアプリのフォルダ削除機能を作る]"
---
# ToDoアプリのフォルダ削除機能を作る
第9章では、ToDoアプリのフォルダ削除機能を作成していきます。

# 今回の目標物
ここで登場するのは、「フォルダ削除ページ」です。

img（フォルダ削除ページの完成見本を配置予定）

# ①ルーティング
まずはルーティングの設定から始めます。

URL 設計を見返していただくと、フォルダ削除機能 の設計は以下の通りです。
| URL | メソッド | 処理 |
| :---- | ---- | :---- |
| /folders/{id}/delete/ | GET | フォルダ削除ページを表示する |
| /folders/{id}/delete/ | POST | フォルダ削除処理を実行する |

`routes/web.php` に以下の2行を追記します。
```js:web.php
/* folders new delete page */
Route::get('/folders/{id}/delete', [FolderController::class,"showDeleteForm"])->name('folders.delete');
Route::post('/folders/{id}/delete', [FolderController::class,"delete"]);
```

# ②フォームを表示する
フォームを表示するルートを実装します。

## コントローラー
`app/Http/Controllers/FolderController` に `showDeleteForm` を追加します。
```js:FolderController.php
class FolderController extends Controller
{
    [中略]
    /**
     *  【フォルダ削除ページの表示機能】
     *  機能：フォルダIDをフォルダ編集ページに渡して表示する
     *
     *  GET /folders/{id}/delete
     *  @param int $id
     *  @return \Illuminate\View\View
     */
    public function showDeleteForm(int $id)
    {
        $folder = Folder::find($id);

        return view('folders/delete', [
            'folder_id' => $folder->id,
            'folder_title' => $folder->title,
        ]);
    }
}
```
ここでは削除対象のフォルダデータを取得してテンプレートに渡しています。

## テンプレート
編集画面が表示された時点で入力欄にはフォルダのタイトルがすでに入っているべきでしょう。テンプレートでフォームを作成する際には、`input` 要素の `value` に値を入れることができるように、DBから取得したフォルダデータを渡すようにしていきます。

まずは、フォルダの編集ページの `blade` を作成します。
```js:Terminal
root~# touch resources/views/folders/delete.blade.php
```
`resources/views/folders/delete.blade.php` を下記のように編集してください。
```js:delete.blade.php
<!--
*   extends：親ビューを継承する（読み込む）
*   親ビュー名：layout を指定
-->
@extends('layout')

<!--
*   section：子ビューにsectionでデータを定義する
*   セクション名：content を指定
*   用途：フォルダを削除するページのHTMLを表示する
-->
@section('content')
<div class="container">
    <div class="row">
    <div class="col col-md-offset-3 col-md-6">
        <nav class="panel panel-default">
            <div class="panel-heading">フォルダを削除する</div>
            <div class="panel-body">
                @if($errors->any())
                    <div class="alert alert-danger">
                        <ul>
                            @foreach($errors->all() as $message)
                                <li>{{ $message }}</li>
                            @endforeach
                        </ul>
                    </div>
                @endif
                <form action="{{ route('folders.delete') }}" method="post">
                    @csrf
                    <div class="form-group">
                        <label for="title">フォルダ名</label>
                        <input type="text" class="form-control" name="title" id="title" value="{{ old('title') ?? $folder_title }}" />
                    </div>
                    <div class="text-right">
                        <button type="submit" class="btn btn-primary">送信</button>
                    </div>
                </form>
            </div>
        </nav>
    </div>
    </div>
</div>
@endsection
```
