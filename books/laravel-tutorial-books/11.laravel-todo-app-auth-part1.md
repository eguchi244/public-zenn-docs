---
title: "入門11 - [ToDoアプリの認証機能を作るPart1]"
---
# ToDoアプリの認証機能を作る
「ToDoアプリの認証機能」については、ボリュームが多いので「Part1, Part2」という風に分けて解説していきます。それぞれに実施する内容については下記の通りです。

【Part1】
- 会員登録機能
- ログイン機能
- ログアウト機能

【Part2】
- ログインしたユーザーは自分のフォルダのタスクだけを閲覧できる機能
- パスワード再設定メール送信機能
- パスワード再設定機能

# ToDoアプリの認証機能を作る Part1
11章では、ToDoアプリの会員登録機能とログイン機能とログアウト機能を実装していきます。

# Laravelの認証方法の種類
Laravelの認証機能を実装する方法には、`Jetstream`、`Breeze`、`Laravel/ui`、`Fortify`があります。どの認証機のを実装するかは、要件や機能によって変わってきます。
今回は、`Laravel/ui` を採用します。

それぞれの機能、メリット・デメリットをまとめてくれている記事があるので紹介しておきます。
https://biz.addisteria.com/laravel_authentication/

# 今回の目標物
ここで登場するのは、「ホームページ, 会員登録ページ, ログインページ」です。

![](/images/laravel-tutorial-books/11.laravel-todo-app-auth-part1/2023-09-16-23-16-23.png)

![](/images/laravel-tutorial-books/11.laravel-todo-app-auth-part1/2023-09-16-23-17-07.png)

img（ホームページを掲載予定）

# ①ユーザーとフォルダを紐づける
まず、データ構造を整えるところから始めましょう。

認証機能の追加にともなって、データ構造としてはまず会員ユーザーが存在して、ユーザーごとに自分のフォルダを作っていく形にしたいと思います。つまり、タスクがフォルダに紐づいているのと同じパターンで、フォルダはユーザーに紐づけるのです。

タスクとフォルダとの関係性をデータ構造で表現するためにどのようなテーブル設計を行ったか覚えていますか？タスクテーブルに 何番のフォルダに紐づいているか という風にフォルダIDのカラムを持たせたのでしたね。今回も同様に、フォルダテーブルにユーザーIDカラムを追加することでユーザーとフォルダの関係性を表現します。

## マイグレーション
テーブル定義に変更を加える場合もマイグレーションの機能を利用します。

まずは、マイグレーションファイルを作成します。
```js:Terminal
root~# php artisan make:migration add_user_id_to_folders --table=folders
```

`database/migrations` ディレクトリに新しく`Y_m_d_His_add_user_id_to_folders.php` というような名前のマイグレーションファイルの雛形が作成されたはずです。

次にマイグレーションファイルを編集します。以下の内容で編集してください。
```js:Y_m_d_His_add_user_id_to_folders.php
<?php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

class AddUserIdToFolders extends Migration
{
    /**
     * Run the migrations.
     * foldersテーブルに user_id 列を追加する
     * 
     * @return void
     */
    public function up()
    {
        Schema::table('folders', function (Blueprint $table) {
            $table->bigInteger('user_id')->unsigned();
            $table->foreign('user_id')->references('id')->on('users');
        });
    }

    /**
     * Reverse the migrations.
     * foldersテーブルの user_id 列を削除する
     * 
     * @return void
     */
    public function down()
    {
        Schema::table('folders', function (Blueprint $table) {
            $table->dropColumn('user_id');
        });
    }
}
```

:::details Y_m_d_His_add_user_id_to_folders.php の解説
コードの意味はコメントで説明しているので確認してみてください。
```js:Y_m_d_His_add_user_id_to_folders.php
<?php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

class AddUserIdToFolders extends Migration
{
    /**
     * Run the migrations.
     * foldersテーブルに user_id 列を追加する
     * 
     * @return void
     */
    public function up()
    {
        Schema::table('folders', function (Blueprint $table) {
            // BIGINT相当の列をUNSIGNED（MySQL）として追加する
            $table->bigInteger('user_id')->unsigned();

            /* 外部キーを'user_id'列に設定する（実在するIDの値以外はBDに入らないようにする） */
            // foreign()：外部キーを設定する列を指定する
            // ->references()：参照する列名を指定する
            // ->on()：参照するテーブル名を指定する
            $table->foreign('user_id')->references('id')->on('users');
        });
    }

    /**
     * Reverse the migrations.
     * foldersテーブルの user_id 列を削除する
     * 
     * @return void
     */
    public function down()
    {
        Schema::table('folders', function (Blueprint $table) {
            // user_id 列を削除する
            $table->dropColumn('user_id');
        });
    }
}
```
:::

`up` メソッドでは `user_id` カラムを追加して外部キーを設定する処理を記述しています。`down` メソッドでは逆に `user_id` カラムを削除する処理を記述しています。

それではマイグレーションを実行しましょう。
```js:Terminal
root~# php artisan make:migration add_user_id_to_folders --table=folders
Deprecated: PHP Startup: Use of mbstring.internal_encoding is deprecated in Unknown on line 0

   INFO  Running migrations.  

  2023_09_20_041003_add_user_id_to_folders ............ 129ms FAIL

   Illuminate\Database\QueryException 

  SQLSTATE[23000]: Integrity constraint violation: 1452 Cannot add or update a child row: a foreign key constraint fails (`mysql_test_db`.`#sql-1_de`, CONSTRAINT `folders_user_id_foreign` FOREIGN KEY (`user_id`) REFERENCES `users` (`id`)) (SQL: alter table `folders` add constraint `folders_user_id_foreign` foreign key (`user_id`) references `users` (`id`))

  at vendor/laravel/framework/src/Illuminate/Database/Connection.php:760
    756▕         // If an exception occurs when attempting to run a query, we'll format the error
    757▕         // message to include the bindings with SQL, which will make this exception a
    758▕         // lot more helpful to the developer instead of just the database's errors.
    759▕         catch (Exception $e) {
  ➜ 760▕             throw new QueryException(
    761▕                 $query, $this->prepareBindings($bindings), $e
    762▕             );
    763▕         }
    764▕     }

      +9 vendor frames 
  10  database/migrations/2023_09_20_041003_add_user_id_to_folders.php:21
      Illuminate\Support\Facades\Facade::__callStatic("table")

      +25 vendor frames 
  36  artisan:37
      Illuminate\Foundation\Console\Kernel::handle(Object(Symfony\Component\Console\Input\ArgvInput), Object(Symfony\Component\Console\Output\ConsoleOutput))
root@e8ca797a568c:/var/www/Laravel9T
```

上記のようにエラーが表示されマイグレーションがうまくいかないはずです。

エラーメッセージを確認してみます。
> `SQLSTATE[23502]: Not null violation: 7 ERROR: column "user_id" contains null values (SQL: alter table "folders" add column "user_id" integer not null)`

`user_id` カラムは `NOT NULL` なのに `NULL` 値が入れられようとした、という内容です。

カラムを追加しただけでデータを入れていないのに、なぜこのエラーが出たかというと、`folders` テーブルにはすでにシーダーや画面から入れたデータが入っているからです。カラムを追加するということはもちろん既存のデータ行にも `user_id` が増えるのですが、このときデータベースは `NULL` を入れようとします。そこでそのカラムが `NOT NULL` だとエラーになるというわけです。

回避策としては、`NULL` 許容にするか、`NULL` ではないデフォルト値を設定するか、データを捨ててテーブルを作り直すか、のどれかになるでしょう。今回の `user_id` カラムは外部キーなので `NULL` を許容できませんしデフォルト値を設定するのも変です。そこでテーブルを作り直します。

または

> `SQLSTATE[23000]: Integrity constraint violation:~`

上記は、整合性制約違反ですという内容です。理由は上記の `NULL` 制限と同様です。
他のエラーメッセージが出たとしても起因する原因は一緒です。
そのため、対処法も同様のものになります。

> 解決策

`migrate:fresh` コマンドを使ってマイグレーションを再実行しましょう。
テーブルをすべて削除してからマイグレーションが実行されます。
```js:Terminal
root~# php artisan migrate:fresh
Deprecated: PHP Startup: Use of mbstring.internal_encoding is deprecated in Unknown on line 0

  Dropping all tables ......................................... 127ms DONE

   INFO  Preparing database.  

  Creating migration table ..................................... 17ms DONE

   INFO  Running migrations.  

  2014_10_12_000000_create_users_table ......................... 23ms DONE
  2014_10_12_100000_create_password_resets_table ............... 29ms DONE
  2019_08_19_000000_create_failed_jobs_table ................... 17ms DONE
  2019_12_14_000001_create_personal_access_tokens_table ........ 22ms DONE
  2023_09_11_020602_create_folders_table ....................... 10ms DONE
  2023_09_11_053002_create_tasks_table ......................... 33ms DONE
  2023_09_20_041003_add_user_id_to_folders ..................... 34ms DONE
```

今度はすべてのマイグレーションが実行されてました。

## ユーザーモデル
次にユーザーとフォルダの関係性をモデルにも記述します。
```js:User.php
class User extends Authenticatable
{
    use HasApiTokens, HasFactory, Notifiable;

    // テーブル名を明示的に指定する
    protected $table = 'users';
    [中略]
    /*
    * ユーザークラスの関係性を辿ってフォルダークラスのリストを取得する
    *
    * @return \Illuminate\Database\Eloquent\Relations\HasMany
    */
    public function folders()
    {
        return $this->hasMany('App\Models\Folder');
    }
}
```
`Folder` モデルに `hasMany` メソッドを追加したのと同様に 1対多 の関係性を定義しています。

## シーダーを再作成する
続いてシーダーを作り直しましょう。`migrate:fresh` によって、すべて捨ててしまったデータを再作成します。また、ユーザーテーブルのためのシーダーも作成します。

> ユーザー

まずは、tasksテーブルのテストデータを挿入するためにシーダーを作成します。
```js:Terminal
root~# php artisan make:seeder UsersTableSeeder
```

`database/seeds/UsersTableSeeder.php` を以下の通り記述してください。
```js:UsersTableSeeder.php
<?php

namespace Database\Seeders;

use Illuminate\Database\Console\Seeds\WithoutModelEvents;
use Illuminate\Database\Seeder;

use Carbon\Carbon;
use Illuminate\Support\Facades\DB;

class UsersTableSeeder extends Seeder
{
    /**
     * Run the database seeds.
     * usersTable用テストデータ
     * 
     * @return void
     */
    public function run()
    {
        DB::table('users')->insert([
            'name' => 'test',
            'email' => 'dummy@email.com',
            'password' => bcrypt('test1234'),
            'created_at' => Carbon::now(),
            'updated_at' => Carbon::now(),
        ]);
    }
}
```

:::details UsersTableSeeder.php の解説
コードの意味はコメントで説明しているので確認してみてください。
```js:UsersTableSeeder.php
<?php

namespace Database\Seeders;

use Illuminate\Database\Console\Seeds\WithoutModelEvents;
use Illuminate\Database\Seeder;

use Carbon\Carbon;
use Illuminate\Support\Facades\DB;

class UsersTableSeeder extends Seeder
{
    /**
     * Run the database seeds.
     * usersTable用テストデータ
     * 
     * @return void
     */
    public function run()
    {
        // usersテーブルにアクセスして行を挿入する
        DB::table('users')->insert([
            // nameに test を代入する
            'name' => 'test',
            // emailに dummy@email.com を代入する
            'email' => 'dummy@email.com',
            // passwordに test1234 を代入する
            // bcrypt()：パスワードをハッシュ化する関数
            'password' => bcrypt('test1234'),
            // 現在の日時を取得してcreated_atに作成日として代入する
            'created_at' => Carbon::now(),
            // 現在の日時を取得してupdated_atに更新日として代入する
            'updated_at' => Carbon::now(),
        ]);
    }
}
```
:::

ポイントは `bcrypt` 関数です。データベース上、ユーザーのパスワードは必ず暗号化してデータベースに保存します。そのまま（「平文」と言います）では保存しません。`bcrypt` 関数は与えられた文字列の暗号化を行います。

> フォルダ

次にフォルダテーブル用のシーダーを修正します。ユーザーに紐付いたフォルダの形でテストデータを流し込めるように修正しています。
```js:FoldersTableSeeder.php
<?php

namespace Database\Seeders;

use Illuminate\Database\Console\Seeds\WithoutModelEvents;
use Illuminate\Database\Seeder;
use Illuminate\Support\Facades\DB;
use Carbon\Carbon;

class FoldersTableSeeder extends Seeder
{
    /**
     * Run the database seeds.
     * foldersTable用テストデータ
     *
     * @return void
     */
    public function run()
    {
        $user = DB::table('users')->first();

        $titles = ['プライベート', '仕事', '旅行'];

        foreach ($titles as $title) {
            DB::table('folders')->insert([
                'title' => $title,
                'user_id' => $user->id,
                'created_at' => Carbon::now(),
                'updated_at' => Carbon::now(),
            ]);
        }
    }
}
```

:::details FoldersTableSeeder.php の解説
コードの意味はコメントで説明しているので確認してみてください。
```js:FoldersTableSeeder.php
<?php

namespace Database\Seeders;

use Illuminate\Database\Console\Seeds\WithoutModelEvents;
use Illuminate\Database\Seeder;
use Illuminate\Support\Facades\DB;
use Carbon\Carbon;

class FoldersTableSeeder extends Seeder
{
    /**
     * Run the database seeds.
     * foldersTable用テストデータ
     *
     * @return void
     */
    public function run()
    {
        /* ユーザーテーブルからユーザー情報を取得する */
        // first()：レコードを1行取得する関数
        $user = DB::table('users')->first();

        /* テストデータを3つ作成する */
        $titles = ['プライベート', '仕事', '旅行'];
        // 上記のタイトルでテーブル行を3つ挿入するループを実行する
        foreach ($titles as $title) {
            // foldersテーブルにアクセスして行を挿入する
            DB::table('folders')->insert([
                // 配列$titlesの値をtitleに代入する
                'title' => $title,
                // ユーザーIDを取得して user_id に代入する
                'user_id' => $user->id,
                // Carbonライブラリで現在の日時を取得してcreated_atに作成日として代入する
                'created_at' => Carbon::now(),
                /// Carbonライブラリで現在の日時を取得してupdated_atに更新日として代入する
                'updated_at' => Carbon::now(),
            ]);
        }
    }
}
```
:::
具体的なポイントは下記の通りです。

下記の部分は `first` メソッドでユーザーを1行だけ取得しています。

```js:FoldersTableSeeder.php
$user = DB::table('users')->first();
```

下記の部分では 上記で取得したユーザー ID を `user_id` の値に指定しています。

```js:FoldersTableSeeder.php
'user_id' => $user->id,
```

ちなみにタスクテーブルはユーザーテーブルとの直接的な関係はありませんので、シーダーを修正する必要もありません。

Seederを実行する前にすべてのシーダーを実行できるように `DatabaseSeeder.php` に下記を追加しておきましょう。
```js:DatabaseSeeder.php
// runメソッド内に追加して順番を入れ替える
$this->call(UsersTableSeeder::class);
$this->call(FoldersTableSeeder::class);
$this->call(TasksTableSeeder::class);
```

それでは Seeder を実行しましょう。
```js:Terminal（まとめて実行する場合）
root~# php artisan db:seed
```

```js:Terminal（個別に実行する場合）
root~# php artisan db:seed --class=UsersTableSeeder
root~# php artisan db:seed --class=FoldersTableSeeder
root~# php artisan db:seed --class=TasksTableSeeder
```

上記のコマンドがうまくいかない場合は `composer dump-autoload` コマンドを打ってから実行し直してください。

ブラウザで [http://localhost:8080](http://localhost:8080) にアクセスしてテーブルを確認してください。

【foldersテーブル】
![](/images/laravel-tutorial-books/11.laravel-todo-app-auth-part1/2023-09-22-14-28-07.png)

上記のように「user_id」列が追加されてデーターが挿入されていればOKです。

# ②ホームページを作成する
ここでホームページ（トップページ）を追加しておきます。これから会員登録やログインの機能を実装しますが、登録やログインが完了した後のリダイレクト先として使います。

## ルーティング
`/` へのアクセスがホームページを返すように記述を追加します。
```js:web.php
use App\Http\Controllers\HomeController;
[中略]
/* home page */
Route::get('/', [HomeController::class,"index"])->name('home');
```

## テンプレート
まずは `resources/views` ディレクトリに `home.blade.php` を作成してください。
```js:home.blade.php
root~# touch resources/views/home.blade.php
```

次に `home.blade.php` を下記のように編集します。
```js:home.blade.php
<!--
*   extends：親ビューを継承する（読み込む）
*   親ビュー名：layout を指定
-->
@extends('layout')

<!--
*   section：子ビューにsectionでデータを定義する
*   セクション名：content を指定
*   用途：ホームページをHTMLで表示する
-->
@section('content')
<div class="container">
    <div class="row">
        <div class="col col-md-offset-3 col-md-6">
            <nav class="panel panel-default">
                <div class="panel-heading">
                    まずはフォルダを作成しましょう
                </div>
                <div class="panel-body">
                    <div class="text-center">
                        <a href="{{ route('folders.create') }}" class="btn btn-primary">
                            フォルダ作成ページへ
                        </a>
                    </div>
                </div>
            </nav>
        </div>
    </div>
</div>
@endsection
```
フォルダを作成していないユーザーにはフォルダを作成するように案内する内容にしています。

## コントローラー
ホームページ用のコントローラーを作成します。
```js:Terminal
root~# php artisan make:controller HomeController
```

次に `HomeController.php` を下記のように編集してください。
内容は、`index` メソッドが先ほど作成したテンプレートの画面を返すだけです。
```js:HomeController.php
<?php

namespace App\Http\Controllers;

use Illuminate\Http\Request;
use Illuminate\Support\Facades\Auth;

class HomeController extends Controller
{
    /**
     *  ホームページを表示するコントローラー
     *  
     *  GET /
     *  @return \Illuminate\View\View
     */
    public function index()
    {
        return view('home');
    }
}
```

それではここで表示を確認してみましょう。
ブラウザで [http://localhost/](http://localhost/) にアクセスしてください。
ホームページが表示されていればOKです。

![](/images/laravel-tutorial-books/11.laravel-todo-app-auth-part1/2023-09-27-15-36-18.png)

# ③会員登録機能
Laravel9以降から `laravel/ui` は廃止されています。そのため、以前までのバージョンと違って、認証系のライブラリを自分でインストールする必要があります。

今では、`laravel/ui` は非推奨で `Breeze` や ` Jetstream` が推奨されています。今回は `laravel/ui` を採用するために途中からインストールしました。

本来であれば、環境構築の段階でインストールしておく方が望ましいです。今回のように途中からインストールするとファイルを書き換えられることがあるからです。

## laravel/ui などの認証系ライブラリをインストールする
まずは、laravel/ui などの認証系ライブラリをインストールします。
```js:Terminals
# laravel/ui をインストールする
root~# composer require laravel/ui
# 認証関係のファイルをインストールする(home.blade.php だけ 'No' にする)
root~# php artisan ui:auth
  The [home.blade.php] view already exists. Do you want to replace it? (yes/no) [no]
❯ no
```
この段階で認証系の様々なファイルが追加されます。例えば `App\Http\Controllers` や `resources/views` に `Auth`ディレクトリと各種のファイルが追加されているはずです。

:::message alert
`home.blade.php` を `yes` で書き換えてしまった場合

ライブラリはファイルを書き換えてしまう時があります。`no` にしていたのはこれを書き換えないようにするためです。もしも、書き換えてしまった場合は、この章で紹介した `home.blade.php` で元の形になるように書き換え直してください。
:::

## ルーティング
それではルーティングをしていきましょう。下記を追加してください。
```diff js:web.php
+ use Illuminate\Support\Facades\Auth;
[中略]
+ /* certification page （会員登録・ログイン・ログアウト・パスワード再設定など） */
+ Auth::routes();
- Route::get('/home', [App\Http\Controllers\HomeController::class, 'index'])->name('home');
```
おそらく `Auth::routes();` はすでに記述されているはずです。このルートが先ほど確認した `php artisan route:list` のルーティングをしてくれています。これにより、会員登録・ログイン・ログアウト・パスワード再設定の各機能で必要なルーティング設定をすべて定義できていることになります。そしてホームページへのルートはすでに記述済みなので消しています。

次にルーティングを確認します。
```js:Terminals
# ルーティングを確認する
root~# php artisan route:list
```
ログインに関連するルートが追加されていることが確認できるはずです。

## ユーザーデータを確認する
テンプレートの実装に進む前に、ユーザーテーブルの構成を確認しておきましょう。

あらかじめ `database/migrations` にユーザーテーブルを作成するためのマイグレーションファイル `Y_m_d_his_create_users_table.php` が組み込まれています。今回はこのテーブル定義をそのまま使いました。

```js:Y_m_d_his_create_users_table.php
Schema::create('users', function (Blueprint $table) {
    $table->id();
    $table->string('name');
    $table->string('email')->unique();
    $table->timestamp('email_verified_at')->nullable();
    $table->string('password');
    $table->rememberToken();
    $table->timestamps();
});
```
![](/images/laravel-tutorial-books/11.laravel-todo-app-auth-part1/2023-09-27-13-10-27.png)

こちらのテーブル定義を前提に実装を進めていきます。

## テンプレート
以下の内容で `resources/views/layouts/app.blade.php` を編集してください。
```js:app.blade.php
<head>
    [中略]
    <!-- Styles -->
    <link rel="stylesheet" href="{{ mix('css/app.css') }}">
</head>
<body>
[中略]
<!-- Scripts -->
<script src="{{ mix('js/app.js') }}" defer></script>
</body>
```
:::details app.blade.php の解説
コードの意味はコメントで説明しているので確認してみてください。
```js:app.blade.php
<head>
    [中略]
    <!-- Styles -->
    <!-- viteの適用を削除するために下記を消しています。 -->
    @vite(['resources/sass/app.scss', 'resources/js/app.js'])
    <!-- LaravelMixを適用するするために追加しています -->
    <link rel="stylesheet" href="{{ mix('css/app.css') }}">
</head>
<body>
[中略]
<!-- Scripts -->
<!-- LaravelMix の Scripts を適用するするために追加しています-->
<script src="{{ mix('js/app.js') }}" defer></script>
</body>
```
:::
ここでは、解説で説明している通りに `Vite`の適用を削除して、`LaravelMix` のCSSとJavascriptを適用できるようにしています。


次に、`resources/views/auth/register.blade.php`以下の内容で編集してください。
```js:register.blade.php
<!--
*   extends：親ビューを継承する（読み込む）
*   親ビュー名：layout を指定
-->
@extends('layout')

<!--
*   section：子ビューにsectionでデータを定義する
*   セクション名：content を指定
*   用途：会員登録ページを表示する
-->
@section('content')
<div class="container">
    <div class="row">
        <div class="col col-md-offset-3 col-md-6">
            <nav class="panel panel-default">
                <div class="panel-heading">会員登録</div>
                <div class="panel-body">
                    @if($errors->any())
                        <div class="alert alert-danger">
                            <ul>
                                @foreach($errors->all() as $message)
                                    <li>{{ $message }}</li>
                                @endforeach
                            </ul>
                        </div>
                    @endif
                    <form action="{{ route('register') }}" method="POST">
                        @csrf
                        <div class="form-group">
                            <label for="email">メールアドレス</label>
                            <input type="text" class="form-control" id="email" name="email" value="{{ old('email') }}" />
                        </div>
                        <div class="form-group">
                            <label for="name">ユーザー名</label>
                            <input type="text" class="form-control" id="name" name="name" value="{{ old('name') }}" />
                        </div>
                        <div class="form-group">
                            <label for="password">パスワード</label>
                            <input type="password" class="form-control" id="password" name="password">
                        </div>
                        <div class="form-group">
                            <label for="password-confirm">パスワード（確認）</label>
                            <input type="password" class="form-control" id="password-confirm" name="password_confirmation">
                        </div>
                        <div class="text-right">
                            <button type="submit" class="btn btn-primary">送信</button>
                        </div>
                    </form>
                </div>
            </nav>
        </div>
    </div>
</div>
@endsection
```

:::details register.blade.php の解説
コードの意味はコメントで説明しているので確認してみてください。
```js:register.blade.php
<!--
*   extends：親ビューを継承する（読み込む）
*   親ビュー名：layout を指定
-->
@extends('layout')

<!--
*   section：子ビューにsectionでデータを定義する
*   セクション名：content を指定
*   用途：会員登録ページを表示する
-->
@section('content')
<div class="container">
    <div class="row">
        <div class="col col-md-offset-3 col-md-6">
            <nav class="panel panel-default">
                <div class="panel-heading">会員登録</div>
                <div class="panel-body">
                    <!-- エラーメッセージを表示する -->
                    <!-- エラーがある場合はIF文の処理を実行する -->
                    @if($errors->any())
                        <div class="alert alert-danger">
                            <ul>
                                <!-- エラーメッセージをループで全て列挙して表示する -->
                                @foreach($errors->all() as $message)
                                    <li>{{ $message }}</li>
                                @endforeach
                            </ul>
                        </div>
                    @endif
                    <!-- Auth::routes()に定義されたルートを指定（php artisan route:list で参照できます） -->
                    <form action="{{ route('register') }}" method="POST">
                        <!-- セキュリティ対策：@csrf は、CSRFトークンを含んだ input 要素を出力します -->
                        @csrf
                        <div class="form-group">
                            <label for="email">メールアドレス</label>
                            <!--
                            *   入力値を復元する
                            *   old()：セッション値を取得する関数（この場合は入力されたタイトルをセッションとして扱う）
                            -->
                            <input type="text" class="form-control" id="email" name="email" value="{{ old('email') }}" />
                        </div>
                        <div class="form-group">
                            <label for="name">ユーザー名</label>
                            <!--
                            *   入力値を復元する
                            *   old()：セッション値を取得する関数（この場合は入力されたタイトルをセッションとして扱う）
                            -->
                            <input type="text" class="form-control" id="name" name="name" value="{{ old('name') }}" />
                        </div>
                        <div class="form-group">
                            <label for="password">パスワード</label>
                            <input type="password" class="form-control" id="password" name="password">
                        </div>
                        <div class="form-group">
                            <label for="password-confirm">パスワード（確認）</label>
                            <!-- 
                            *   パスワード一致確認機能（ confirmed ルール）
                            *   name="目名（password）_confirmation"で表現されて入力値が一致するか検証しています。
                            -->
                            <input type="password" class="form-control" id="password-confirm" name="password_confirmation">
                        </div>
                        <div class="text-right">
                            <button type="submit" class="btn btn-primary">送信</button>
                        </div>
                    </form>
                </div>
            </nav>
        </div>
    </div>
</div>
@endsection
```
:::

このbladeの二つのポイントについて解説します。

> 認証機能のルート

まず一つ目は認証機能のルート名についてです。
```js:register.blade.php
<form action="{{ route('register') }}" method="POST">
```
上記のように `route` という名前を指定していますが、このルート名は `Auth::routes()` で定義されています。これはルーティングの定義を一覧表示する `route:list` で確認できます。

```js:Terminal
root~# php artisan route:list
  [中略]
  GET|HEAD   register ........................................... register › Auth\RegisterController@showRegistrationForm
  POST       register .................................................................. Auth\RegisterController@register
  [中略]
```
ここでは、`form`タグ で `method`プロパティ で `POST` を指定しているので、POST側のルートを経由しています。このように `action`プロパティを使用すれば、指定したルートを経由して、使用したいコントローラーを動かすことができることを覚えておきましょう。

> パスワード一致確認

続いてのポイントは「パスワード一致確認機能」です。

Laravel には [confirmed](https://readouble.com/laravel/9.x/ja/validation.html#rule-confirmed) ルールというバリデーションルールが実装されています。このルールはある項目（仮に `abc` とします）と `その項目名 + _confirmation` という名前の項目（`abc_confirmation`）の入力値が一致することを検証します。

```js:register.blade.php
<input type="password" class="form-control" id="password-confirm" name="password_confirmation">
```

確認用のパスワード欄の `name`プロパティ が `password_confirmation` という名前であるのはこのルールを適用するためです。

## コントローラー
会員登録機能を受け持つのは `app/Http/Controllers/Auth/RegisterController.php` です。
`RegisterController.php` を下記のように修正してください。
```js:RegisterController.php
class RegisterController extends Controller
{
    [中略]
    protected $redirectTo = RouteServiceProvider::HOME;
    [中略]

    protected function validator(array $data)
    {
        return Validator::make($data, [
            'name' => ['required', 'string', 'max:255'],
            'email' => ['required', 'string', 'email', 'max:255', 'unique:users'],
            'password' => ['required', 'string', 'min:8', 'confirmed'],

        ], [], [
            'name' => 'ユーザー名',
            'email' => 'メールアドレス',
            'password' => 'パスワード',
        ]);
    }
    [中略]
}
```

:::details RegisterController.php の解説
コードの意味はコメントで説明しているので確認してみてください。
```js:RegisterController.php
<?php

namespace App\Http\Controllers\Auth;

use App\Http\Controllers\Controller;
use App\Providers\RouteServiceProvider;
use App\Models\User;
use Illuminate\Foundation\Auth\RegistersUsers;
use Illuminate\Support\Facades\Hash;
use Illuminate\Support\Facades\Validator;

class RegisterController extends Controller
{
    /*
    |--------------------------------------------------------------------------
    | Register Controller
    |--------------------------------------------------------------------------
    |
    | This controller handles the registration of new users as well as their
    | validation and creation. By default this controller uses a trait to
    | provide this functionality without requiring any additional code.
    |
    */

    use RegistersUsers;

    /**
     * Where to redirect users after registration.
     *
     * @var string
     */
    protected $redirectTo = RouteServiceProvider::HOME;

    /**
     * Create a new controller instance.
     *
     * @return void
     */
    public function __construct()
    {
        $this->middleware('guest');
    }

    /**
     * Get a validator for an incoming registration request.
     *
     * @param  array  $data
     * @return \Illuminate\Contracts\Validation\Validator
     */
    protected function validator(array $data)
    {
        /* Validator::make(検証データ, [ルール定義], [メッセージ定義], [項目名定義]); */
        return Validator::make($data, [
            /* ユーザー名の入力欄を下記のように定義する */
            // required：入力必須
            // string：値を文字列形式に指定
            // max:255：入力最大値を255文字に指定
            'name' => ['required', 'string', 'max:255'],

            /* メールアドレスの入力欄を下記のように定義する */
            // required：入力必須
            // string：値を文字列形式に指定
            // email：値をEmailアドレス形式に指定
            // max:255：入力最大値を255文字に指定
            // unique:users：DBのusersテーブルで使用済みか確認する
            'email' => ['required', 'string', 'email', 'max:255', 'unique:users'],

            /* ユーザー名の入力欄を下記のように定義する */
            // required：入力必須
            // string：値を文字列形式に指定
            // min:8：入力最小値を8文字に指定
            // confirmed：confirmed バリデーションルールを指定（「名目_confirmationの入力欄と一致する」に指定）
            'password' => ['required', 'string', 'min:8', 'confirmed'],

        ], [], [
            'name' => 'ユーザー名',
            'email' => 'メールアドレス',
            'password' => 'パスワード',
        ]);
    }

    /**
     * Create a new user instance after a valid registration.
     *
     * @param  array  $data
     * @return \App\Models\User
     */
    protected function create(array $data)
    {
        return User::create([
            'name' => $data['name'],
            'email' => $data['email'],
            'password' => Hash::make($data['password']),
        ]);
    }
}
```
:::

`$redirectTo` は登録に成功した後のリダイレクト先です。
ここでは、Laravelのデフォルトページを指定しています。

このように Laravel の認証機能は、そのままでも十分使えるデフォルト設定が組み込まれた上で簡単にカスタマイズできるように作られています。

次に、Laravelアプリのデフォルトページを設定を変更します。
`app/Providers/RouteServiceProvider.php` の下記の部分を修正しましょう。
```diff js:RouteServiceProvider.php
+ public const HOME = '/';
- public const HOME = '/home';
```
これでLaravelアプリのデフォルトページURLが「`/`」（ホームページ）に変更されるので、会員登録後のリダイレクトでホームページに遷移されるようになります。

それではここで表示を確認してみましょう。
ブラウザで [http://localhost/register](http://localhost/register) にアクセスしてください。

![](/images/laravel-tutorial-books/11.laravel-todo-app-auth-part1/2023-09-27-15-34-40.png)

上記のように会員登録ページが正常に表示されればOKです。

:::message alert
会員登録処理のテストについて

ここで「会員登録」を確認したいところですが今は実施しません。

ログアウト機能を実装していない状態で、「会員登録処理」をするとLaravelの認証ステータスがログイン状態になってしまうからです。ログアウト機能を実装していないのでログアウトもできない状態になってしまうからです。

これでは困ってしまうのでテストはログアウト機能を実装した後に実施します。

そのためテストは画面の表示とエラーメッセージの確認のみに留めることにします。
:::

## 入力エラーメッセージの日本語化
会員登録処理にもバリデーションが定義されています。メッセージを日本語化しましょう。

> コントローラー

`RegisterController` の `validator` メソッドでバリデーションが定義されています。このように `FormRequest` クラスを使わずに、コントローラーの中で `Validator` クラスの `make` メソッドからバリデーション定義を作成する方法もあることを覚えておきましょう。なお、コードはすでに記述されているはずです。

```js:RegisterController.php
protected function validator(array $data)
{
    return Validator::make($data, [
        'name' => ['required', 'string', 'max:255'],
        'email' => ['required', 'string', 'email', 'max:255', 'unique:users'],
        'password' => ['required', 'string', 'min:8', 'confirmed'],

    ], [], [
        'name' => 'ユーザー名',
        'email' => 'メールアドレス',
        'password' => 'パスワード',
    ]);
}
```

> バリデーションファイル（メッセージファイル）

続いてメッセージファイルを自然な日本語化にします。
`resources/lang/jp/validation.php` のうち、以下の項目を編集してください。

```js:validation.php
'confirmed'            => ':attribute が確認欄と一致していません。',
'email'                => ':attribute には有効な形式のメールアドレスを入力してください。',
'min'                  => [
    // [中略]
    'string'  => ':attribute は:min文字以上で入力してください。',
    // [中略]
],
'string'               => ':attribute には文字を入力してください。',
'unique'               => '入力いただいた :attribute はすでに使用されています。',
```

それではエラーメッセージ表示を確認してみましょう。
ブラウザで [http://localhost/register](http://localhost/register) にアクセスしてください。
会員登録フォームに色々な不正値を入力してみてエラーメッセージが日本語化されていることを確かめてください。

まずは、何も入力しないで会員登録をしてみてください。
![](/images/laravel-tutorial-books/11.laravel-todo-app-auth-part1/2023-10-04-13-28-02.png)
入力が必須に設定されているので上記のメッセージが表示されます。

次に下記の入力内容で会員登録をしてみてください。
:::message
【会員登録エラーデータ】

メールアドレス : メールアドレスの形式ではない255文字以上の文字列
ユーザー名 : 255文字以上の文字列
パスワード : 8文字以下の文字列
パスワード（確認）: 上記のパスワードとは異なる文字列
:::

![](/images/laravel-tutorial-books/11.laravel-todo-app-auth-part1/2023-10-04-13-32-21.png)
上記のようなエラーメッセージが表示されたはずです。


いかがだったでしょうか？それぞれのエラーメッセージが表示されればOKです。

# ④ログイン機能
次にログイン機能を実装していきます。

## テンプレート
`resources/views/auth/login.blade.php` を以下の内容で作成してください。
```js:login.blade.php
<!--
*   extends：親ビューを継承する（読み込む）
*   親ビュー名：layout を指定
-->
@extends('layout')

<!--
*   section：子ビューにsectionでデータを定義する
*   セクション名：content を指定
*   用途：ログインページを表示する
-->
@section('content')
<div class="container">
    <div class="row">
        <div class="col col-md-offset-3 col-md-6">
            <nav class="panel panel-default">
                <div class="panel-heading">ログイン</div>
                <div class="panel-body">
                    @if($errors->any())
                        <div class="alert alert-danger">
                        <ul>
                            @foreach($errors->all() as $message)
                                <li>{{ $message }}</li>
                            @endforeach
                        </ul>
                        </div>
                    @endif
                    <form action="{{ route('login') }}" method="POST">
                        @csrf
                        <div class="form-group">
                            <label for="email">メールアドレス</label>
                            <input type="text" class="form-control" id="email" name="email" value="{{ old('email') }}" />
                        </div>
                        <div class="form-group">
                            <label for="password">パスワード</label>
                            <input type="password" class="form-control" id="password" name="password" />
                        </div>
                            <div class="text-right">
                            <button type="submit" class="btn btn-primary">送信</button>
                        </div>
                    </form>
                </div>
            </nav>
            <div class="text-center">
                <a href="{{ route('password.request') }}">パスワードの変更はこちらから</a>
            </div>
        </div>
    </div>
</div>
@endsection
```

:::details login.blade.php の解説
コードの意味はコメントで説明しているので確認してみてください。
```js:login.blade.php
<!--
*   extends：親ビューを継承する（読み込む）
*   親ビュー名：layout を指定
-->
@extends('layout')

<!--
*   section：子ビューにsectionでデータを定義する
*   セクション名：content を指定
*   用途：ログインページを表示する
-->
@section('content')
<div class="container">
    <div class="row">
        <div class="col col-md-offset-3 col-md-6">
            <nav class="panel panel-default">
                <div class="panel-heading">ログイン</div>
                <div class="panel-body">
                    <!-- エラーメッセージを表示する -->
                    <!-- エラーがある場合はIF文の処理を実行する -->
                    @if($errors->any())
                        <div class="alert alert-danger">
                        <ul>
                            <!-- エラーメッセージをループで全て列挙して表示する -->
                            @foreach($errors->all() as $message)
                                <li>{{ $message }}</li>
                            @endforeach
                        </ul>
                        </div>
                    @endif
                    <form action="{{ route('login') }}" method="POST">
                        <!-- セキュリティ対策：@csrf は、CSRFトークンを含んだ input 要素を出力します -->
                        @csrf
                        <div class="form-group">
                            <label for="email">メールアドレス</label>
                            <!--
                            *   入力値を復元する
                            *   old()：セッション値を取得する関数（この場合は入力されたタイトルをセッションとして扱う）
                            -->
                            <input type="text" class="form-control" id="email" name="email" value="{{ old('email') }}" />
                        </div>
                        <div class="form-group">
                            <label for="password">パスワード</label>
                            <input type="password" class="form-control" id="password" name="password" />
                        </div>
                            <div class="text-right">
                            <button type="submit" class="btn btn-primary">送信</button>
                        </div>
                    </form>
                </div>
            </nav>
            <div class="text-center">
                <a href="{{ route('password.request') }}">パスワードの変更はこちらから</a>
            </div>
        </div>
    </div>
</div>
@endsection
```
:::

## コントローラー
会員登録のときと同じように、ログインに成功したあとの遷移先を指定します。
`app/Http/Controllers/Auth/LoginController.php` の下記の部分を確認しましょう。
```js:LoginController.php
protected $redirectTo = RouteServiceProvider::HOME;
```
会員登録ページの時と同様にリダイレクト先が Laravelアプリのデフォルトページ「`/`」（ホームページ）に指定されています。そのため、ログイン後に「`/`」（ホームページ）にリダイレクトされます。

それではここで表示を確認してみましょう。
ブラウザで [http://localhost/login](http://localhost/login) にアクセスしてください。

![](/images/laravel-tutorial-books/11.laravel-todo-app-auth-part1/2023-10-13-13-46-27.png)

ログインページが表示されればOKです。

:::message alert
ログイン処理のテストについて

ここで「ログイン」を確認したいところですが今は実施しません。

ログアウト機能を実装していない状態で、「ログイン処理」をするとLaravelの認証ステータスがログイン状態になってしまうからです。ログアウト機能を実装していないのでログアウトもできない状態になってうからです。

これでは困ってしまうのでテストはログアウト機能を実装した後に実施します。

そのためテストは画面の表示とエラーメッセージの確認のみに留めることにします。
:::

## メッセージの日本語化
ログインに失敗したときのエラーメッセージを日本語化します。

ログインエラーメッセージは `./resources/lang/ja/auth.php` で管理されています。
`auth.php` の `faild` キーの値を自然な日本語に修正しましょう。
```js:auth.php
'failed' => 'メールアドレスまたはパスワードに誤りがあります。',
```

それではログインエラーのメッセージを確認してみましょう。
ブラウザで [http://localhost/login](http://localhost/login) にアクセスしてください。
会員登録されていない情報でエラーになるようにログインしてください。

![](/images/laravel-tutorial-books/11.laravel-todo-app-auth-part1/2023-10-05-14-28-02.png)

上記の画像のようにログインエラーが表示されればOKです。

# ⑤ヘッダーのログインメニューを作成する
ヘッダーのログインメニューを作成していきます。

これによりログイン状態に応じて表示を切り替えるようにしていきます。

![](/images/laravel-tutorial-books/11.laravel-todo-app-auth-part1/2023-10-05-14-29-15.png)

![](/images/laravel-tutorial-books/11.laravel-todo-app-auth-part1/2023-10-05-14-30-02.png)

上記のようにログイン前後で右側のリンクが変化します。ログイン前はログイン画面へのリンクと会員登録画面へのリンクを表示し、ログイン後のヘッダーではユーザー名を含んだメッセージとログアウトリンクを表示します。

それでは、`resources/views/layout.blade.php` の `<header>` 要素を以下の内容で書き換えてください。
```js:layout.blade.php
<header>
    <nav class="my-navbar">
        <a class="my-navbar-brand" href="/">ToDo App</a>
        <div class="my-navbar-control">
            @if(Auth::check())
                <span class="my-navbar-item">ようこそ, {{ Auth::user()->name }}さん</span>
                ｜
                <a href="#" id="logout" class="my-navbar-item">ログアウト</a>
                <form id="logout-form" action="{{ route('logout') }}" method="POST" style="display: none;">
                    @csrf
                </form>
            @else
                <a class="my-navbar-item" href="{{ route('login') }}">ログイン</a>
                ｜
                <a class="my-navbar-item" href="{{ route('register') }}">会員登録</a>
            @endif
        </div>
    </nav>
</header>
```

:::details layout.blade.php の解説
コードの意味はコメントで説明しているので確認してみてください。
```js:layout.blade.php
<header>
    <nav class="my-navbar">
        <a class="my-navbar-brand" href="/">ToDo App</a>
        <div class="my-navbar-control">
            <!-- ログインユーザーの取得 -->
            <!-- Auth::check() :ログイン状態を確認する関数（ログイン状態でtrueを返す） -->
            @if(Auth::check())
                <!-- ログイン時にユーザー名を表示する -->
                <span class="my-navbar-item">ようこそ, {{ Auth::user()->name }}さん</span>
                ｜
                <a href="#" id="logout" class="my-navbar-item">ログアウト</a>
                <!-- ログアウトがクリックされた時にイベントスクリプトと処理を呼び出す -->
                <form id="logout-form" action="{{ route('logout') }}" method="POST" style="display: none;">
                    <!-- セキュリティ対策：@csrf は、CSRFトークンを含んだ input 要素を出力します -->
                    @csrf
                </form>
            @else
                <a class="my-navbar-item" href="{{ route('login') }}">ログイン</a>
                ｜
                <a class="my-navbar-item" href="{{ route('register') }}">会員登録</a>
            @endif
        </div>
    </nav>
</header>
```
:::

ポイントを2つありますので、それぞれを解説していきます。

## ログイン状態の取得
ひとつ目のポイントは、ログイン状態の取得です。

`Auth` クラスの `check` メソッドでログインしているかどうかを確認しています。アクセスしたユーザーがログインしていれば `Auth::check()` は `true` を返し、ログインしていなければ `false` を返します。

テンプレートではこの `Auth::check()` を利用してログインしていた場合の要素とログインしていない場合の要素をログイン状態に応じて変化させています。

```js:ログイン状態の取得例
@if(Auth::check())
  <!-- ログインしていた場合 -->
@else
  <!-- ログインしていない場合 -->
@endif
```

`Auth::check()` とは逆の働きをする `guest` メソッドも存在します。つまり `Auth::guest()` はユーザーがログインしていない場合に `true` を返します。

## ログインユーザーの取得
ふたつ目は、ログインユーザーの取得です。

```js:ログインユーザーの取得例
<span class="my-navbar-item">ようこそ, {{ Auth::user()->name }}さん</span>
```

`Auth::user()` でログイン中のユーザーを取得できます。返却値はログインユーザーの情報が入った `User` モデルのインスタンスです。

`Auth::check()` や `Auth::user()` はコントローラーなどでも使用することができます。実際に後述の処理でも使用します。便利なメソッドですので覚えておきましょう。

# ⑥ログアウト
次に、ログアウトの機能を実装していきます。

`layout.blade.php` の `@yield('scripts')` の上に以下のコードを追加してください。

```js:layout.blade.php
<!--
*   ログアウトのクリックイベント
*   機能：ログアウトリンクのクリック時に真下のログアウトフォームを送信する
*   用途：ログアウトを実施する
-->
@if(Auth::check())
    <script>
        document.getElementById('logout').addEventListener('click', function(event) {
        event.preventDefault();
        document.getElementById('logout-form').submit();
        });
    </script>
@endif
```

:::details layout.blade.php の解説
コードの意味はコメントで説明しているので確認してみてください。
```js:layout.blade.php
<body>
    [中略]
    </main>
    <!--
    *   ログアウトのクリックイベント
    *   機能：ログアウトリンクのクリック時に真下のログアウトフォームを送信する
    *   用途：ログアウトを実施する
    -->
    @if(Auth::check())
        <script>
            // ログアウトがクリックされたらイベントを実施する
            document.getElementById('logout').addEventListener('click', function(event) {
            // 現在のURLにフォームの内容を送信するデフォルトの処理をキャンセルする（イベントを中断するリロードのキャンセル）
            event.preventDefault();
            // ログアウトフォームの内容を送信する
            document.getElementById('logout-form').submit();
            });
        </script>
    @endif
    @yield('scripts')
</body>
```
:::

ログアウト機能として必要なのは `route('logout')` の URL に `POST` リクエストを送信することだけです。今回はリンク（`<a>` 要素）をフォームを送信したかったので JavaScriptのクリックイベントを使用しています。ログアウトリンクのクリックイベントで、リンクの下に置いたフォームを送信しています。`POST` リクエストに必要なデータは `CSRF` トークンのみです。

# ⑦認証機能の動作確認をする
ここまでに、「会員登録ページ, ログインページ, ログアウトページ」を作成しました。

ログアウトページが作成されるまでは動作確認が出来なかったものがありましたよね？ここでは未実施の処理の動作確認をしていきます。

> 会員登録処理とログイン状態のヘッダーメニュー

まずは、会員登録処理の確認を実施していきます。
ブラウザで [http://localhost/register](http://localhost/register) にアクセスしてください。
下記のテストデータで会員登録してみましょう。

:::message
【会員テストデータ】
Email：test1234@email.com
氏名：TEST01
パスワード：test1234
パスワード（確認）：test1234
:::

いかがでしょうか？登録が正常に行われてホームページに遷移していれば大丈夫です。
ヘッダーメニューのユーザー名も会員登録した「TEST01」になっていて、その横にログアウトリンクが表示されているはずです。

![](/images/laravel-tutorial-books/11.laravel-todo-app-auth-part1/2023-10-13-15-08-40.png)

phpMyAdminからユーザーデータの行が追加されていることも確認しましょう。
ブラウザで [http://localhost:8080](http://localhost:8080) にアクセスしてください。
ユーザーデータの行が追加されていればOKです。

> ログアウト処理と未ログイン状態のヘッダーメニュー

次に、ログアウト処理の確認を実施していきます。
会員登録後のリダイレクト先の画面からそのまま作業してください。
ブラウザを閉じてしまった人は  [http://localhost/](http://localhost/) にアクセスしてください。
それではログアウトをクリックしてください。

![](/images/laravel-tutorial-books/11.laravel-todo-app-auth-part1/2023-10-05-14-21-20.png)

ログアウト後にログインページにリダイレクトされていればOKです。
ヘッダーメニューも ログインリンク と 会員登録リンク が表示されているはずです。

> ログイン処理

次に、ログイン処理の確認を実施していきます。
ログアウト後のリダイレクト先の画面からそのまま作業してください。
ブラウザを閉じてしまった人は  [http://localhost/login](http://localhost/login) にアクセスしてください。
下記のテストデータでログインしてみましょう。

:::message
【会員テストデータ（Seederテストデータ）】
Email：dummy@email.com
氏名：test
パスワード：test1234
パスワード（確認）：test1234
:::

![](/images/laravel-tutorial-books/11.laravel-todo-app-auth-part1/2023-10-05-14-18-27.png)

ログイン後にホームページにリダイレクトできていればOKです。
最後にログアウトしておいてください。

# まとめ
この章では、ToDoアプリのそれぞれの認証機能を作成しました。

ここまでの内容で

- ホームページ機能とホームページの実装
- laravel/ui などの認証系ライブラリの導入
- 会員登録機能と会員登録ページの実装
- 会員登録処理のバリデーションと日本語化
- ログイン機能とログインページの実装
- ログイン処理のバリデーションと日本語化
- ヘッダーのログインメニューの実装
- ログアウト機能の実装

などを実施しました。

今回は認証系（ログイン機能, ログアウト機能）の機能を中心に実施しました。

今までと違うのは、`CRUD` というアプリの基本機能ではなく、認証機能という応用技術を実施した点です。

次回からはさらに認証系機能の発展的な応用技術を実施していきます。

ここまでのソースコードを下記に掲載しておきます。
確認などにご活用ください。
https://github.com/eguchi244/Laravel9-Tutorial-PJ/tree/Chapter11/ToDoアプリの認証機能を作るPart1


