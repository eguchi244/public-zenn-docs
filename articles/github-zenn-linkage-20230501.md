---
title: "ZennとGithubを連携する方法"
emoji: "👻"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["Zenn", "Github"]
published: true # 公開に指定する
---
# はじめに
Zennとgithubを連携してみようと調べてみたところ、セットアップ方法の記事は多く見かけましたが、その後の運用まで考慮されたものは少ないように感じました。そのため、運用にも対応するために本記事を執筆することにします。

念の為にZennの公式記事を掲載しておきます。

ZennとGithubを連携する方法
https://zenn.dev/zenn/articles/connect-to-github
Zenn CLIで記事を作成する方法
https://zenn.dev/zenn/articles/install-zenn-cli

# 目的
Zennとgithubを連携して、GitHubリポジトリでZennのコンテンツを管理する。
連携することのメリットを下記に列挙しておきます。
- プレビューしながら記事を書ける
- 記事のバージョン管理が行える
- Githubにプッシュすると自動的にZennの記事が作成やアップデートされる
- 記事のプルリクエストがGithubで出来る
- 以前の記事のバージョンに戻す事もできる
- Githubにデータが残っているので復元が可能である

# 内容
ZennとGithubを連携するには、下記の3ステップだけです。

1. ZennとGithubを連携する
2. Zenn CLIで記事を作成する環境を作る
3. Githubを使用して記事を作成する

さっそく、はじめてみましょう。

# ZennとGithubを連携する
前提としてGithubアカウントとZennアカウントは作成済みであることを想定しています。
### ①GithubにZenn連携用リポジトリを作成する
GithubにZenn連携用リポジトリを作成します。空のレポジトリを作成しておきましょう。
公開設定はPublicでもPrivateでもOKです。
:::message
Githubの機能（issue,pull requestなど）を、積極的に活用する予定のある人は、「リポジトリ名」で内容が判断できる方が良いと思います。例えば、プルリクエストで編集リクエストをする場合などです。この時に「zenn-contents」などの、他の人も使っているリポジトリ名だと、同名のレポジトリ名が並んで使いづらい可能性もあるからです。例えば「ユーザー名-zenn-contents」や「公開状態-zenn-contents」などが良いと思います。ここでは「public-zenn-docs」としておきました。
:::
![](/images/github-zenn-linkage-20230501/2023-05-12-13-37-14.png =600x)

### ②GithubにZenn連携用リポジトリを作成する
Zennにログインして、[GitHubからのデプロイ](https://zenn.dev/dashboard/deploys) を開いて「リポジトリを連携する」を押します。
![](/images/github-zenn-linkage-20230501/2023-05-12-13-38-43.png)
「リポジトリを連携」を選んで、GithubGitHubの認証画面に進みましょう。そこで「Only select repositories」を選択して、先ほど作成したレポジトリを選択してください。2つ目のリポジトリを登録する際は、再度「Only select repositories」を選択して、リポジトリを選択してください。最後に「インストール」を押しましょう。
:::message
連携できるリポジトリは最大2つです。3つ以上選択されていると連携が失敗します。これは安全のための意図的な仕様とのことです。後述する有料出版する人には重要な要素となります。
:::
:::message alert
有料出版をする人は管理するリポジトリに注意しましょう。有料販売するまではプライベートリポジトリにしておいた方が良いからです。パブリックリポジトリとプライベートリポジトリをあらかじめ用意しておいて、執筆中はプライベートリポジトリで作成して、執筆完了後にパブリックリポジトリに移植するなどの対処が必要そうです。もしくは、リポジトリを「公開と非公開」で必要に応じて切り替えることでしょうか。他の公開すべきものまで非公開になってしまうので現実的ではありませんが...。
:::
![](/images/github-zenn-linkage-20230501/2023-05-12-13-40-00.png =600x)
これでGithubとの連携は完了です。

### ③同期するブランチ名を確認・変更する
[リポジトリ設定タブ](https://zenn.dev/dashboard/deploys?tab=repo_settings) から、同期したいブランチ名を確認・変更ができます。「設定を変更」から変更してください。なお、ここで登録されている名前のブランチに変更があったときに自動でデプロイが行われます。
![](/images/github-zenn-linkage-20230501/2023-05-12-13-41-10.png)
これでファイルを push すれば、投稿ができるようになっているはずです。一方で、ZennのWebページからは、投稿ができなくなる点に注意してください。
![](/images/github-zenn-linkage-20230501/2023-05-12-13-42-03.png)
ただし、画像のアップロードはこの画面からできます。記事に埋め込めるリンクが簡単に取得できますので覚えておくと良いでしょう。

# Zenn CLI で記事を作成する環境を作る
Githubを使用して記事を作成するために、ローカルで記事を作成するための「 Zenn CLI 」を導入していきましょう。ローカルの好きなエディターで投稿コンテンツの作成・編集ができるようになります。基本は公式の手順通りです。
https://zenn.dev/zenn/articles/install-zenn-cli

### ①GitHub上のリポジトリをローカルへのクローンする
GitHub上で作成したZennコンテンツ用のリポジトリをローカルにクローンします。GitHub上からクローンしたいリポジトリのページに行ってコピーボタンをクリックします。
![](/images/github-zenn-linkage-20230501/2023-05-12-13-46-53.png)
ターミナルでローカルリポジトリを作成するフォルダに移動して以下のコマンドを実行します。
```
$ git clone https://github.com/************.git
```
その後、ローカルにGitHub上と同じ名前のフォルダが作成できていれば成功です。
:::message
ターミナルでGitHub上と同じ名前のフォルダに移動するのを忘れないようにしましょう。
:::

### ②Zenn CLIをインストールする
まずは、Node.js(npm)がインストールされているか確認します。
```
$ npm -v
```
バージョンが表示されていれば、Node.js(npm)はインストールされています。
Node.jsがインストールされていなければ、下記を参考にインストールしてください。
https://kinsta.com/jp/blog/how-to-install-node-js/

次に、Zenn CLI をインストールしてアップデートしていきます。
```
$ npm init --yes # プロジェクトをデフォルト設定で初期化
$ npm install zenn-cli # zenn-cliを導入
$ npm install zenn-cli@latest # zenn-cliをアップデート
```
コマンド実行後のディレクトリに、自動でフォルダとファイルが生成されていれば成功です。

### ③Zenn用のセットアップをする
続いて以下の`npx`コマンドを実行します。
```
$ npx zenn init
```
下記のようになっていれば成功です。
![](/images/github-zenn-linkage-20230501/2023-05-12-13-48-14.png =400x)
これで Zenn CLI で記事を作成する準備は完了です。

# Githubを使用して記事を作成する
記事の作成の方法は、以下の公式ページが参考になります。
https://zenn.dev/zenn/articles/zenn-cli-guide
上記で十分ではありますが、一応ここでも簡単な記事の作成方法をご紹介しておきます。

### ①記事を作成する
記事を作成するために、以下の`npx`コマンドを実行します。
```
$ npx zenn new:article --slug github-zenn-linkage-20230501
```
:::message
```
$ npx zenn new:article
```
だけでも記事を作成できますが、機械的なスラッグ（ファイル名）なので使いにくいです。
「 --slug 」を使うとスラッグ（ファイル名）を指定して、記事が作成できるので便利です。
但し、他の人が使っているスラッグ名はデプロイに失敗する点に注意してください。
末尾に年月日などを付けるのが無難でしょう。
:::
下記のように新しい記事が出来ていれば成功です。
![](/images/github-zenn-linkage-20230501/2023-05-12-13-49-27.png =500x)
作成した記事（github-zenn-linkage-20230501.md）を開くと、中身は次のようになっています。
![](/images/github-zenn-linkage-20230501/2023-05-12-13-50-31.png =550x)
ここに記事のタイトル（title）やトピックス（topics）などを yaml形式 で指定していきます。
試しに下記のように書き換えて保存してみましょう。
![](/images/github-zenn-linkage-20230501/2023-05-12-13-51-35.png =550x)

### ②記事をプレビューする
それでは、記事を表示してみましょう。次の`npx`コマンドを実行します。
```
$ npx zenn preview # プレビュー開始
$ 👀 Preview: http://localhost:8000
```
上記のURLをコピーしてブラウザに貼り付けて読み込んでください。
もしくは、下記のリンクカードからアクセスしてみましょう。
http://localhost:8000/
![](/images/github-zenn-linkage-20230501/2023-05-12-13-54-04.png =600x)
:::message alert
上記のURLでアクセスされるのは、記事ではなく「 Zenn Editor 」という専用のページです。
記事を表示するには、赤枠で囲った記事のタイトルをクリックしてください。
:::
![](/images/github-zenn-linkage-20230501/2023-05-12-13-55-06.png =600x)
:::message
ポートが被ってしまった場合などは、`$ npx zenn preview --port 8888` というように、オプションを付けて起動することにより、ポート番号を変えていくこともできます。
:::
これでプレビューは完了です。表示を見たい時は、この操作をしてください。

### ③記事をGithubでバージョン管理する
最後に公開された記事を、Githubでバージョン管理していきましょう。
```
$ git branch -M main # ブランチ名を main にする
$ git add . # ステージングする
$ git commit -m "first commit" # コミットする
$ git push -u origin main # pushする
```
下記のようにGithubにファイルなどができて、共有された状態になりました。
![](/images/github-zenn-linkage-20230501/2023-05-12-13-56-39.png)
これで記事をGithubで管理することができました。
作業はこれで完了です。

# まとめ
これで少なくとも最低限は、バックアップがとれている状態になりました。安心ですよね。
改めてGithubでバージョン管理するメリットを列挙しておきます。

- プレビューしながら記事を書ける
- 記事のバージョン管理が行える
- Githubにプッシュすると自動的にZennの記事が作成やアップデートされる
- 記事のプルリクエストがGithubで出来る
- 以前の記事のバージョンに戻す事もできる
- Githubにデータが残っているので復元が可能である

上記のメリットは執筆活動には必須なものでもあります。
このように執筆活動を「安心・安全・便利」に行うことは出来るようになります。
この記事が皆様のお役に立てれば嬉しいです。